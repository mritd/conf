# ============================================================================
# Tmux é…ç½®æ–‡ä»¶
# TPM å®‰è£…: git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
# æ’ä»¶å®‰è£…: Ctrl+s I
# é¢œè‰²å‚è€ƒ: https://jonasjacek.github.io/colors/
# ============================================================================

# ============================================================================
# åŸºç¡€è®¾ç½®
# ============================================================================

# å‰ç¼€é”®æ”¹ä¸º Ctrl+s
unbind C-b
set -g prefix C-s

# å†å²è®°å½•å’Œæ˜¾ç¤º
set -g history-limit 50000
set -g display-time 4000

# ç„¦ç‚¹äº‹ä»¶ (ç”¨äº vim ç­‰åº”ç”¨)
set -g focus-events on

# OSC 52 å‰ªè´´æ¿æ”¯æŒ
set -s set-clipboard on

# é˜²æ­¢è‡ªåŠ¨å…³é—­ Session
set -g destroy-unattached off

# ============================================================================
# ç»ˆç«¯å…¼å®¹æ€§ (Alacritty / Ghostty / é€šç”¨)
# ============================================================================

# é»˜è®¤ç»ˆç«¯ç±»å‹
set -g default-terminal "tmux-256color"

# çœŸå½©è‰² (RGB) å’Œå‰ªè´´æ¿æ”¯æŒ
set -ga terminal-overrides ",alacritty:RGB:clipboard"
set -ga terminal-overrides ",xterm-ghostty:RGB:clipboard"
set -ga terminal-overrides ",xterm-256color:RGB:clipboard"

# æ‰©å±•é”®ç›˜æ”¯æŒ (tmux 3.2+, ç”¨äºæ­£ç¡®ä¼ é€’ä¿®é¥°é”®ç»„åˆ)
set -g extended-keys on
set -as terminal-features 'xterm*:extkeys'

# ============================================================================
# çª—å£å’Œé¢æ¿
# ============================================================================

# çª—å£/é¢æ¿ç¼–å·ä» 1 å¼€å§‹
set -g base-index 1
set -wg pane-base-index 1

# çª—å£é‡å‘½å
set -wg allow-rename on
set -wg automatic-rename on

# Vi æ¨¡å¼
set -wg mode-keys vi

# ============================================================================
# å¿«æ·é”®
# ============================================================================

# "C-s R" é‡è½½é…ç½®
bind R source-file ~/.tmux.conf \; display-message "Config reloaded..."

# "C-s s" é€‰æ‹© session (æŒ‰åç§°æ’åº)
bind s choose-tree -s -r -O name -K ''

# "C-s m" åˆ‡æ¢é¼ æ ‡æ”¯æŒ
bind m run-shell 'if [ "$(tmux show-option -gq mouse)" = "mouse on" ]; then tmux set -g mouse off; else tmux set -g mouse on; fi' \; display-message "Mouse toggled"

# "C-s y" åˆ‡æ¢é¢æ¿åŒæ­¥
bind y run-shell 'if [ "$(tmux show-option -gq synchronize-panes)" = "synchronize-panes on" ]; then tmux set -g synchronize-panes off; else tmux set -g synchronize-panes on; fi' \; display-message "Pane sync toggled"

# ============================================================================
# çŠ¶æ€æ 
# ============================================================================

# åˆ·æ–°é—´éš”
set -g status-interval 1

# å¯¹é½æ–¹å¼
set -g status-justify absolute-centre

# èƒŒæ™¯é€æ˜, æ–‡å­—é¢œè‰²
set -g status-bg default
set -g status-fg white
set -g status-style fg=brightgreen

# å·¦ä¾§: Session åç§°
set -g status-left '#[fg=brightcyan]#S'
set -g status-left-length 20

# å³ä¾§: ç³»ç»Ÿä¿¡æ¯ + æ—¶é—´
set -g status-right '#[fg=brightcyan]#($TMUX_PLUGIN_MANAGER_PATH/tmux-sysinfo/tmux-sysinfo --mini --enabled=cpu,mem,load) | [%H:%M]'
set -g status-right-length 80

# æ¶ˆæ¯æ ·å¼
set -g message-style fg=brightgreen

# çª—å£æ ‡é¢˜
set -wg window-status-format '#[dim]#I:#W'
set -wg window-status-current-format '#[fg=brightcyan,bold]#I:#W'

# é¢æ¿ç¼–å·æ˜¾ç¤ºé¢œè‰²
set -g display-panes-active-colour brightgreen
set -g display-panes-colour brightyellow

# ============================================================================
# æ’ä»¶
# ============================================================================

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'mritd/tmux-sysinfo'
set -g @plugin 'MunifTanjim/tmux-suspend'

# tmux-suspend é…ç½®
set -g @suspend_key 'F12'
set -g @suspend_suspended_options " \
    status-left::#[bg=brightblack]--------, \
    status-right::#[bg=brightblack][-----], \
    window-status-current-format::#[bg=brightblack]----- \
"

# åˆå§‹åŒ– TPM (ä¿æŒåœ¨æœ€å)
run '~/.tmux/plugins/tpm/tpm'

# ============================================================================
# é¢„è®¾ Sessions
# ============================================================================

new-session -d -s 'ğŸ local'
new-session -d -s 'ğŸŒ‹ test'
new-session -d -s 'ğŸŒ€ prod'
